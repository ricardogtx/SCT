google.load('visualization', '1', {'packages': ['geochart']});
     google.setOnLoadCallback(drawMarkersMap);

      function drawMarkersMap() {
      var data = google.visualization.arrayToDataTable([
        ['State',   'Clinicas'],
        <% State.all.each do |state| %>
        <%= "['BR-#{state.uf}', #{state.clinics.count}], " %>
        <% end %>
      ]);

      var options = {
        region: 'BR',
        resolution: 'provinces',
        datalessRegionColor:  'transparent',
        colorAxis: {colors: ['#FFFF00','#FF4D00']},
        backgroundColor: { fill:'transparent' }
      };

      var chart = new google.visualization.GeoChart(document.getElementById('geochart_div'));
      chart.draw(data, options);

      google.visualization.events.addListener(chart, 'regionClick', function (event) {
        var state = (event.region.split("-")[1]);
        window.location.href = "/clinics?state=" + state;
      });

};